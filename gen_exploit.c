/* gen_exploit.c */

#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv) {
  char buffer[40];
  FILE *exploit_file;

  exploit_file = fopen("./lab4file", "w");

  /* Place 3 addresses at offsets X, Y, and Z in lab4file.
     A basic attack involves the address of the system function, a
     string to pass to system(), and address of the exit() function. */
  *(long *) &buffer[X] = 0xAAAAAAAA ;
  *(long *) &buffer[Y] = 0xBBBBBBBB ;
  *(long *) &buffer[Z] = 0xCCCCCCCC ;

  fwrite(buffer, sizeof(buffer), 1, exploit_file);
  fclose(exploit_file);
}
